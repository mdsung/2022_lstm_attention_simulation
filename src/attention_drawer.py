import matplotlib.pyplot as plt
import torch


def drawer(epoch, model):
    fig, ax = plt.subplots()
    test_X0 = torch.Tensor(
        [
            [
                [9.9247e-01, 9.9877e-01, 1.0089e00, 9.8526e-01, 9.8865e-01],
                [1.0024e00, 9.9736e-01, 1.0082e00, 1.0034e00, 1.0037e00],
                [1.0153e00, 1.0125e00, 1.0087e00, 1.0123e00, 1.0092e00],
                [1.0048e00, 9.8169e-01, 1.0116e00, 9.8826e-01, 9.9637e-01],
                [9.9832e-01, 1.0085e00, 1.0063e00, 9.9466e-01, 1.0193e00],
                [1.0151e00, 1.0004e00, 1.0150e00, 1.0006e00, 9.9446e-01],
                [1.0054e00, 1.0127e00, 1.0037e00, 1.0028e00, 9.9282e-01],
                [1.0091e00, 9.9154e-01, 9.7752e-01, 9.9038e-01, 1.0009e00],
                [9.9331e-01, 1.0047e00, 1.0003e00, 9.9978e-01, 1.0052e00],
                [9.9203e-01, 9.9138e-01, 9.9095e-01, 9.9417e-01, 9.9412e-01],
            ]
        ]
    )
    test_Y0 = torch.Tensor([[1.0, 0.0]])
    test_X1 = torch.Tensor(
        [
            [
                [1.0164e00, 9.9125e-01, 9.9313e-01, 9.9193e-01, 1.0036e00],
                [9.9371e-01, 9.9837e-01, 9.8830e-01, 9.8427e-01, 9.9181e-01],
                [9.7352e-01, 1.0071e00, 9.8453e-01, 9.9931e-01, 1.0035e00],
                [1.0067e00, 9.9476e-01, 9.9840e-01, 1.0106e00, 1.0010e00],
                [1.0051e00, 1.0087e00, 1.0047e00, 9.9447e-01, 1.0039e00],
                [8.0532e-03, -9.4786e-03, 7.5599e-03, -5.5172e-05, 1.4620e-02],
                [
                    -9.8640e-03,
                    1.2220e-02,
                    -2.2777e-02,
                    -9.8315e-03,
                    -2.1980e-03,
                ],
                [4.5949e-03, -1.4084e-02, 6.4299e-03, 5.9212e-03, -5.8892e-03],
                [-1.0504e-03, -1.7470e-02, 7.8785e-03, 8.4332e-03, -4.2807e-03],
                [1.5241e-02, 6.4404e-03, 3.0690e-03, -2.7860e-04, 1.5572e-02],
            ]
        ]
    )
    test_Y1 = torch.Tensor([[0.0, 1.0]])
    attention_drawer(model, test_X0, test_Y0, "b")
    attention_drawer(model, test_X1, test_Y1, "orange")
    plt.legend()
    plt.title(f"Epoch {epoch}")
    plt.savefig(f"figures/attention_{epoch}.png")


def attention_drawer(model, test_X, test_y, color):
    _, attention = model(test_X)
    plt.plot(
        attention.detach().cpu().numpy().squeeze(0),
        c=color,
        label=test_y.detach().cpu().numpy().squeeze(0),
    )
